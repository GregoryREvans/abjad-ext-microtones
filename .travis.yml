language: python
dist: xenial
sudo: false
python:
- 3.8

env:
  global:
  - LILYPOND_URL="http://lilypond.org/downloads/binaries/linux-64/"
  - LILYPOND_VERSION=2.19.84

before_install:
- wget -q ${LILYPOND_URL}lilypond-${LILYPOND_VERSION}-1.linux-64.sh
- sh lilypond-$LILYPOND_VERSION-1.linux-64.sh --batch
- export PATH=/home/travis/bin:$PATH
- pip install -U pip regex
- export ABJAD_ARCHIVE=https://github.com/Abjad/abjad/archive/master.zip
- pip install -U $ABJAD_ARCHIVE
- pip install --no-deps --target /tmp/typehints $ABJAD_ARCHIVE
- pip install --no-deps --target /tmp/typehints uqbar
- export MYPYPATH=/tmp/typehints
# clone & install evans:
- EVANS=/tmp/evans
- git clone https://github.com/GregoryREvans/evans.git $EVANS
- export PYTHONPATH=$EVANS/:$PYTHONPATH
- export PATH=$EVANS/evans/scr/:$PATH

install:
- pip install -e .[test]
- black --version
- flake8 --version
- mypy --version
- pytest --version

script:
- black-check $PACKAGE
- flake8-check $PACKAGE
- isort-check $PACKAGE
- evans-doctest $PACKAGE

after_success:
- pip install --quiet coveralls
- coveralls
